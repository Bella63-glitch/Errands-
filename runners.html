<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Run Me An Errand - Detailed Runners</title> 
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"> 
  <style>  
        /* Custom CSS for colors */  
        :root {  
            --maroon: #7B1E3A;  
            --gold: #FFD700;  
            --light-gold: #FFEB80; /* A lighter shade for backgrounds */  
        }  
        .bg-maroon { background-color: var(--maroon); }  
        .text-gold { color: var(--gold); }  
        .bg-gold { background-color: var(--gold); }  
        .border-gold { border-color: var(--gold); }  
        .bg-light-gold { background-color: var(--light-gold); }  /* Animation for runner cards */  
    @keyframes fadeInSlideUp {  
        from { opacity: 0; transform: translateY(20px); }  
        to { opacity: 1; transform: translateY(0); }  
    }  
    .animate-fade-in-slide-up {  
        animation: fadeInSlideUp 0.6s ease-out forwards;  
    }  

    /* Loading spinner */  
    .loader {  
        border: 4px solid #f3f3f3;  
        border-top: 4px solid var(--maroon);  
        border-radius: 50%;  
        width: 40px;  
        height: 40px;  
        animation: spin 1s linear infinite;  
    }  
    @keyframes spin {  
        0% { transform: rotate(0deg); }  
        100% { transform: rotate(360deg); }  
    }  


    /* Mobile Menu Styles */  
    .mobile-menu {  
        transition: max-height 0.3s ease-in-out;  
        overflow: hidden;  
        max-height: 0;  
    }  
    .mobile-menu.active {  
        max-height: 500px; /* Sufficiently large to show all content */  
    }  

    /* Modal specific styles */  
    .modal {  
        display: none; /* Hidden by default */  
        position: fixed; /* Stay in place */  
        z-index: 1000; /* Sit on top */  
        left: 0;  
        top: 0;  
        width: 100%; /* Full width */  
        height: 100%; /* Full height */  
        overflow: auto; /* Enable scroll if needed */  
        background-color: rgba(0,0,0,0.6); /* Black w/ opacity */  
        justify-content: center;  
        align-items: center;  
    }  
    .modal-content {  
        background-color: #fefefe;  
        margin: auto;  
        padding: 0; /* Changed from 30px to 0 for internal padding control */  
        border-radius: 12px;  
        width: 90%;  
        max-width: 800px;  
        position: relative;  
        animation: fadeInScale 0.3s ease-out forwards;  
        max-height: 90vh; /* Max height for modal content */  
        overflow-y: auto; /* Enable scrolling within modal */  
        -webkit-overflow-scrolling: touch; /* For smoother scrolling on iOS */  
    }  
    @keyframes fadeInScale {  
        from { opacity: 0; transform: scale(0.95); }  
        to { opacity: 1; transform: scale(1); }  
    }  
    .close-button {  
        color: #aaa;  
        position: absolute;  
        top: 15px;  
        right: 25px;  
        font-size: 36px;  
        font-weight: bold;  
        cursor: pointer;  
        transition: color 0.3s;  
        z-index: 1010; /* Ensure it's above modal header */  
    }  
    .close-button:hover,  
    .close-button:focus {  
        color: var(--maroon);  
        text-decoration: none;  
        cursor: pointer;  
    }  

    /* Skeleton loader for cards */  
    .skeleton {  
        background-color: #e2e8f0; /* bg-gray-200 */  
        border-radius: 8px;  
        animation: pulse 1.5s infinite ease-in-out;  
    }  

    .skeleton-circle {  
        width: 96px; /* w-24 */  
        height: 96px; /* h-24 */  
        border-radius: 50%;  
    }  

    .skeleton-text {  
        height: 1em;  
        width: 80%;  
        margin-bottom: 0.5em;  
    }  
    .skeleton-text.long {  
        width: 90%;  
    }  
    .skeleton-text.short {  
        width: 60%;  
    }  
    @keyframes pulse {  
        0% { opacity: 0.6; }  
        50% { opacity: 1; }  
        100% { opacity: 0.6; }  
    }  
</style> 
 </head> 
 <body class="bg-gray-50 text-gray-800 font-sans"> 
  <header class="bg-maroon shadow-md sticky top-0 z-50"> 
   <div class="max-w-7xl mx-auto flex justify-between items-center py-5 px-6"> <a href="index.html" class="flex items-center space-x-2"> <img src="https://img.icons8.com/fluent/48/ffffff/running.png" alt="Errand Logo"> <h1 class="text-2xl font-bold text-white transition-colors duration-300 hover:text-gold">Run Me An Errand</h1> </a> 
    <nav class="hidden md:flex space-x-6 text-lg"> <a href="index.html" class="text-gray-300 hover:text-gold transition-colors duration-300">Home</a> <a href="index.html#how-it-works" class="text-gray-300 hover:text-gold transition-colors duration-300">How It Works</a> <a href="index.html#why-choose-us" class="text-gray-300 hover:text-gold transition-colors duration-300">Why Choose Us</a> <a href="index.html#testimonials" class="text-gray-300 hover:text-gold transition-colors duration-300">Reviews</a> <a href="index.html#contact" class="text-gray-300 hover:text-gold transition-colors duration-300">Contact</a> <a href="#" class="text-gray-300 hover:text-gold transition-colors duration-300">Become a Runner</a> 
    </nav> 
    <div class="hidden md:flex space-x-4"> <a href="#" class="bg-gold text-maroon px-4 py-2 rounded-full hover:bg-white hover:text-maroon transition duration-300">Login</a> <a href="#" class="bg-white text-maroon px-4 py-2 rounded-full hover:bg-gold hover:text-maroon transition duration-300">Sign Up</a> 
    </div> 
    <div class="md:hidden"> <button id="mobile-menu-button" class="text-gray-300 hover:text-gold focus:outline-none focus:ring-2 focus:ring-gold"> 
      <svg class="h-6 w-6 fill-current" viewbox="0 0 24 24"> <path fill-rule="evenodd" clip-rule="evenodd" d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"></path> 
      </svg></button> 
    </div> 
   </div> 
   <nav id="mobile-menu" class="mobile-menu md:hidden bg-maroon pb-4"> <a href="index.html" class="block px-6 py-2 text-white hover:bg-maroon-dark hover:text-gold transition-colors duration-300">Home</a> <a href="index.html#how-it-works" class="block px-6 py-2 text-white hover:bg-maroon-dark hover:text-gold transition-colors duration-300">How It Works</a> <a href="index.html#why-choose-us" class="block px-6 py-2 text-white hover:bg-maroon-dark hover:text-gold transition-colors duration-300">Why Choose Us</a> <a href="index.html#testimonials" class="block px-6 py-2 text-white hover:bg-maroon-dark hover:text-gold transition-colors duration-300">Reviews</a> <a href="index.html#contact" class="block px-6 py-2 text-white hover:bg-maroon-dark hover:text-gold transition-colors duration-300">Contact</a> <a href="#" class="block px-6 py-2 text-white hover:bg-maroon-dark hover:text-gold transition-colors duration-300">Become a Runner</a> 
    <div class="px-6 pt-4 flex flex-col space-y-3"> <a href="#" class="bg-gold text-maroon px-4 py-2 rounded-full text-center hover:bg-white hover:text-maroon transition duration-300">Login</a> <a href="#" class="bg-white text-maroon px-4 py-2 rounded-full text-center hover:bg-gold hover:text-maroon transition duration-300">Sign Up</a> 
    </div> 
   </nav> 
  </header> 
  <main class="py-12 px-6"> 
   <div class="max-w-7xl mx-auto"> 
    <h2 class="text-4xl font-extrabold text-maroon text-center mb-4">Discover Your Ideal Runner</h2> 
    <p class="text-xl text-gray-700 text-center mb-10">Browse through our trusted runners and call them to book with confidence.</p> 
    <div class="bg-white p-6 rounded-lg shadow-md mb-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"> 
     <div> <label for="location-filter" class="block text-sm font-medium text-gray-700 mb-2">Your Location:</label> <select id="location-filter" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-maroon focus:border-maroon"> <option value="all">All Locations</option> <option value="Nairobi">Nairobi</option> <option value="Mombasa">Mombasa</option> <option value="Kisumu">Kisumu</option> <option value="Eldoret">Eldoret</option> <option value="Nakuru">Nakuru</option> </select> 
     </div> 
     <div> <label for="availability-filter" class="block text-sm font-medium text-gray-700 mb-2">Availability:</label> <select id="availability-filter" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-maroon focus:border-maroon"> <option value="all">All</option> <option value="Available">Available Now</option> </select> 
     </div> 
     <div> <label for="sort-by" class="block text-sm font-medium text-gray-700 mb-2">Sort By:</label> <select id="sort-by" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-maroon focus:border-maroon"> <option value="rating">Rating (Highest First)</option> <option value="tasksCompleted">Tasks Completed (Most First)</option> <option value="distance">Closest to Me</option> </select> 
     </div> 
     <div class="md:col-span-2 lg:col-span-3 text-center"> <button id="apply-filters" class="w-full md:w-auto bg-maroon text-white px-8 py-3 rounded-md hover:bg-gold hover:text-maroon transition duration-300 font-semibold shadow-lg">Apply Filters &amp; Find Runners</button> 
     </div> 
    </div> 
    <div id="status-container" class="mb-8 min-h-[80px] flex items-center justify-center"> 
     <div id="no-runners-found" class="text-center p-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 rounded-lg hidden"> 
      <p class="text-lg font-semibold mb-2">No runners match your criteria.</p> 
      <p class="text-md">Try adjusting your filters.</p> 
     </div> 
     <div id="fetch-error" class="text-center p-4 bg-red-100 border-l-4 border-red-500 text-red-700 rounded-lg hidden"> 
      <p class="text-lg font-semibold mb-2">Failed to load runners data.</p> 
      <p class="text-md">There was a problem connecting to the server. Please try again later.</p> 
     </div> 
    </div> 
    <div id="runners-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"> 
     <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200"> 
      <div class="skeleton-circle mb-4 skeleton"></div> 
      <div class="skeleton-text long skeleton"></div> 
      <div class="skeleton-text short skeleton"></div> 
      <div class="skeleton-text skeleton w-full mt-3"></div> 
      <div class="skeleton-text skeleton w-1/2 mt-2"></div> 
      <div class="skeleton-text skeleton w-full h-8 mt-4"></div> 
     </div> 
     <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200"> 
      <div class="skeleton-circle mb-4 skeleton"></div> 
      <div class="skeleton-text long skeleton"></div> 
      <div class="skeleton-text short skeleton"></div> 
      <div class="skeleton-text skeleton w-full mt-3"></div> 
      <div class="skeleton-text skeleton w-1/2 mt-2"></div> 
      <div class="skeleton-text skeleton w-full h-8 mt-4"></div> 
     </div> 
     <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200 hidden lg:flex"> 
      <div class="skeleton-circle mb-4 skeleton"></div> 
      <div class="skeleton-text long skeleton"></div> 
      <div class="skeleton-text short skeleton"></div> 
      <div class="skeleton-text skeleton w-full mt-3"></div> 
      <div class="skeleton-text skeleton w-1/2 mt-2"></div> 
      <div class="skeleton-text skeleton w-full h-8 mt-4"></div> 
     </div> 
     <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200 hidden xl:flex"> 
      <div class="skeleton-circle mb-4 skeleton"></div> 
      <div class="skeleton-text long skeleton"></div> 
      <div class="skeleton-text short skeleton"></div> 
      <div class="skeleton-text skeleton w-full mt-3"></div> 
      <div class="skeleton-text skeleton w-1/2 mt-2"></div> 
      <div class="skeleton-text skeleton w-full h-8 mt-4"></div> 
     </div> 
    </div> 
   </div> 
  </main> 
  <div id="runner-modal" class="modal"> 
   <div class="modal-content"> <span class="close-button">×</span> 
    <div id="modal-content-area"> 
     <div class="bg-maroon text-white p-6 rounded-t-lg text-center relative overflow-hidden"> 
      <img id="modal-runner-photo" src="" alt="Runner Photo" class="w-32 h-32 rounded-full object-cover mx-auto mb-4 border-4 border-gold shadow-lg transform translate-y-8 relative z-10"> 
      <div class="pt-8 pb-4"> 
       <h3 id="modal-runner-name" class="text-3xl font-extrabold mb-1"></h3> 
       <div class="flex items-center justify-center mb-2"> 
        <div id="modal-runner-rating-stars" class="flex"> 
        </div> <span id="modal-runner-rating-value" class="font-semibold ml-2"></span> <span id="modal-runner-tasks" class="text-gray-300 text-sm ml-2"></span> 
       </div> 
       <p id="modal-runner-availability" class="text-md font-bold px-4 py-1 rounded-full inline-block mt-2"></p> 
      </div> 
     </div> 
     <div class="bg-white p-6 pb-2 grid grid-cols-1 md:grid-cols-2 gap-y-6 gap-x-8 -mt-8 relative z-0 rounded-b-lg"> 
      <div> 
       <h4 class="text-xl font-bold text-maroon mb-3 border-b pb-2 border-gray-200">About <span id="modal-about-runner-name"></span></h4> 
       <p id="modal-runner-bio" class="text-gray-700 leading-relaxed text-sm"></p> 
      </div> 
      <div> 
       <h4 class="text-xl font-bold text-maroon mb-3 border-b pb-2 border-gray-200">Key Details</h4> 
       <ul class="space-y-2 text-gray-700 text-sm"> 
        <li><strong class="text-maroon">Current Location:</strong> <span id="modal-runner-location"></span></li> 
        <li><strong class="text-maroon">Hourly Rate:</strong> <span id="modal-runner-rate"></span></li> 
        <li><strong class="text-maroon">Vehicle Type:</strong> <span id="modal-runner-vehicle"></span></li> 
        <li><strong class="text-maroon">Avg. Response Time:</strong> <span id="modal-runner-response-time"></span></li> 
        <li><strong class="text-maroon">Languages Spoken:</strong> <span id="modal-runner-languages"></span></li> 
       </ul> <a id="modal-runner-map-link" href="#" target="_blank" class="text-blue-600 hover:underline text-sm mt-4 flex items-center hidden"> 
        <svg class="w-4 h-4 mr-1" fill="currentColor" viewbox="0 0 20 20"> <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path> 
        </svg> View Runner's Base on Map </a> 
      </div> 
      <div> 
       <h4 class="text-xl font-bold text-maroon mb-3 border-b pb-2 border-gray-200">Recent Reviews</h4> 
       <div id="modal-runner-reviews" class="space-y-4 text-sm"> 
       </div> 
      </div> 
     </div> 
     <div class="bg-gray-50 p-6 pt-4 text-center rounded-b-lg border-t border-gray-200"> <button id="modal-call-now-btn" class="bg-gold text-maroon px-8 py-3 rounded-full font-bold text-lg hover:bg-maroon hover:text-white transition duration-300 shadow-xl w-full md:w-2/3">Call Now</button> 
      <p class="text-gray-600 text-xs mt-3">We'll connect you directly to the runner to discuss your errand.</p> 
     </div> 
    </div> 
   </div> 
  </div> 
  <footer class="bg-gray-800 text-gray-300 py-12"> 
   <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-8"> 
    <div> 
     <h4 class="text-lg font-bold text-gold mb-4">Run Me An Errand</h4> 
     <p class="text-sm mb-2">Your reliable partner for errand services across Kenya.</p> 
     <p class="text-sm">© 2025 Run Me An Errand. All rights reserved.</p> 
    </div> 
    <div> 
     <h4 class="text-lg font-bold text-gold mb-4">Quick Links</h4> 
     <ul class="space-y-2 text-sm"> 
      <li><a href="index.html" class="hover:text-gold transition-colors duration-200">Home</a></li> 
      <li><a href="#" class="hover:text-gold transition-colors duration-200">Services</a></li> 
      <li><a href="index.html#how-it-works" class="hover:text-gold transition-colors duration-200">How It Works</a></li> 
      <li><a href="index.html#why-choose-us" class="hover:text-gold transition-colors duration-200">Why Choose Us</a></li> 
      <li><a href="index.html#testimonials" class="hover:text-gold transition-colors duration-200">Reviews</a></li> 
      <li><a href="index.html#contact" class="hover:text-gold transition-colors duration-200">Contact Us</a></li> 
      <li><a href="#" class="hover:text-gold transition-colors duration-200">Become a Runner</a></li> 
      <li><a href="#" class="hover:text-gold transition-colors duration-200">FAQ</a></li> 
      <li><a href="#" class="hover:text-gold transition-colors duration-200">Privacy Policy</a></li> 
      <li><a href="#" class="hover:text-gold transition-colors duration-200">Terms of Service</a></li> 
     </ul> 
    </div> 
    <div> 
     <h4 class="text-lg font-bold text-gold mb-4">Contact Info</h4> 
     <p class="text-sm mb-2">Email: <a href="mailto:support@runerrand.co.ke" class="hover:text-gold">support@runerrand.co.ke</a></p> 
     <p class="text-sm mb-2">Phone: <a href="tel:+254712345678" class="hover:text-gold">+254 712 345 678</a></p> 
     <div class="flex space-x-4 mt-4"> <a href="#" class="text-gray-300 hover:text-gold" aria-label="Twitter"> 
       <svg class="h-5 w-5 fill-current" viewbox="0 0 24 24"> <path fill="currentColor" d="M22.46 6c-.77.67-1.72 1.13-2.77 1.33a4.76 4.76 0 002.07-2.62c-.82.48-1.75.83-2.79 1.02a4.78 4.78 0 00-8.13 4.3A13.54 13.54 0 013.57 4.3c.83 1.42 2.08 2.4 3.57 3.07a4.78 4.78 0 00-2.22-.61c.3-.08.59-.12.88-.12a4.78 4.78 0 004.46 3.31 9.5 9.5 0 01-5.78 1.98c-.34-.1-.68-.16-1.02-.18a4.75 4.75 0 004.88 3.3 9.5 9.5 0 01-7.64 3.27c-.36-.02-.72-.03-1.08-.03a13.57 13.57 0 006.94 2.16c4.16 0 7.67-3.46 7.67-7.67 0-.12 0-.23-.34-.69a4.66 4.66 0 001.53-1.3"></path> 
       </svg></a> <a href="#" class="text-gray-300 hover:text-gold" aria-label="Facebook"> 
       <svg class="h-5 w-5 fill-current" viewbox="0 0 24 24"> <path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.88V15H8v-3h2V9.5c0-2.17 1.34-3.34 3.27-3.34 1.83 0 2.93 1.5 2.93 3.34V12h2v3h-2v6.88c4.56-1.01 8-5.04 8-9.88z"></path> 
       </svg></a> <a href="#" class="text-gray-300 hover:text-gold" aria-label="Instagram"> 
       <svg class="h-5 w-5 fill-current" viewbox="0 0 24 24"> <path fill="currentColor" d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.148 3.252-1.691-4.771-4.919-4.919.058-1.265-.069-1.644-.069-4.849 0-3.205.012-3.584.069-4.849.148-3.252 1.691-4.771 4.919-4.919 1.265-.058 1.644-.07 4.849-.07zM12 6.893c-2.857 0-5.146 2.289-5.146 5.146 0 2.857 2.289 5.146 5.146 5.146 2.857 0 5.146-2.289 5.146-5.146 0-2.857-2.289-5.146-5.146-5.146zm0 8.469c-1.827 0-3.333-1.506-3.333-3.333 0-1.827 1.506-3.333 3.333-3.333 1.827 0 3.333 1.506 3.333 3.333 0 1.827-1.506 3.333-3.333 3.333z"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.998c-4.414 0-8 3.586-8 8 0 4.414 3.586 8 8 8 4.414 0 8-3.586 8-8 0-4.414-3.586-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-3.31 2.69-6 6-6 3.31 0 6 2.69 6 6 0 3.31-2.69 6-6 6z"></path> 
       </svg></a> 
     </div> 
    </div> 
   </div> 
  </footer> <button id="back-to-top" class="fixed bottom-6 right-6 bg-maroon text-white p-3 rounded-full shadow-lg hover:bg-gold hover:text-maroon transition duration-300 hidden"> 
   <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path> 
   </svg> </button> 
  <script>  
    document.addEventListener('DOMContentLoaded', function() {  
        // --- Backendless Credentials ---  
        const APP_ID = "9223CBD1-9AFC-4C74-B56B-12F11D319DF9";  
        const API_KEY = "0C3700EB-013B-4BFE-85ED-CE0F6F7EC013";  
        let runnersData = [];  // --- DOM Elements ---  
    const runnersListDiv = document.getElementById('runners-list');  
    const noRunnersFoundDiv = document.getElementById('no-runners-found');  
    const fetchErrorDiv = document.getElementById('fetch-error');  
    const locationFilter = document.getElementById('location-filter');  
    const availabilityFilter = document.getElementById('availability-filter');  
    const sortBy = document.getElementById('sort-by');  
    const applyFiltersButton = document.getElementById('apply-filters');  
    const mobileMenuButton = document.getElementById('mobile-menu-button');  
    const mobileMenu = document.getElementById('mobile-menu');  
    const backToTopButton = document.getElementById('back-to-top');  

    // Modal Elements  
    const runnerModal = document.getElementById('runner-modal');  
    const closeModalButton = document.querySelector('.close-button');  
    const modalRunnerPhoto = document.getElementById('modal-runner-photo');  
    const modalRunnerName = document.getElementById('modal-runner-name');  
    const modalAboutRunnerName = document.getElementById('modal-about-runner-name');  
    const modalRunnerRatingStars = document.getElementById('modal-runner-rating-stars');  
    const modalRunnerRatingValue = document.getElementById('modal-runner-rating-value');  
    const modalRunnerTasks = document.getElementById('modal-runner-tasks');  
    const modalRunnerAvailability = document.getElementById('modal-runner-availability');  
    const modalRunnerLocation = document.getElementById('modal-runner-location');  
    const modalRunnerMapLink = document.getElementById('modal-runner-map-link');  
    const modalRunnerBio = document.getElementById('modal-runner-bio');  
    const modalRunnerRate = document.getElementById('modal-runner-rate');  
    const modalRunnerVehicle = document.getElementById('modal-runner-vehicle');  
    const modalRunnerResponseTime = document.getElementById('modal-runner-response-time');  
    const modalRunnerLanguages = document.getElementById('modal-runner-languages');  
    const modalRunnerReviews = document.getElementById('modal-runner-reviews');  
    const modalCallNowBtn = document.getElementById('modal-call-now-btn');  

    // --- Helper: Get Profile Image URL ---  
    function getRunnerImageUrl(imageUrl) {  
        return imageUrl || "https://via.placeholder.com/96/7B1E3A/FFD700?text=RM";  
    }  

    // --- Helper: Generate Star HTML ---  
    function generateStarRating(rating) {  
        let starsHtml = '';  
        const fullStars = Math.floor(rating);  
        const hasHalfStar = rating % 1 >= 0.5;  

        for (let i = 0; i < fullStars; i++) {  
            starsHtml += '<svg class="w-5 h-5 text-gold fill-current" viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>';  
        }  
        if (hasHalfStar) {  
            starsHtml += '<svg class="w-5 h-5 text-gold fill-current" viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>';  
        }  
        return starsHtml;  
    }  

    // --- Display Runners Function ---  
    function displayRunners(runnersToDisplay) {  
        runnersListDiv.innerHTML = '';  
        runnersListDiv.classList.remove('hidden');  

        if (runnersToDisplay.length === 0) {  
            setStatusMessage('no_runners');  
            runnersListDiv.classList.add('hidden');  
            return;  
        } else {  
            setStatusMessage('success');  
        }  

        runnersToDisplay.forEach((runner, index) => {  
            const runnerCard = document.createElement('div');  
            runnerCard.className = `bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 cursor-pointer animate-fade-in-slide-up`;  
            runnerCard.style.animationDelay = `${index * 0.1}s`;  
            runnerCard.dataset.runnerId = runner.objectId;  

            const availabilityClass = runner.isavailable ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700';  
            const photoUrl = getRunnerImageUrl(runner.imageurl);  

            runnerCard.innerHTML = `  
                <img src="${photoUrl}" alt="${runner.name}" class="w-24 h-24 rounded-full object-cover mb-4 border-2 border-gold shadow-md">  
                <h3 class="text-xl font-bold text-maroon mb-1">${runner.name}</h3>  
                <div class="flex items-center justify-center mb-2">  
                    ${generateStarRating(runner.rating || 0)}  
                    <span class="text-gray-700 font-medium ml-1">${(runner.rating || 0).toFixed(1)}</span>  
                    <span class="text-gray-500 text-sm ml-2">(${runner.tasksCompleted || 0} tasks)</span>  
                </div>  
                <p class="text-sm text-gray-500 mt-2">${runner.location ? `Based in ${runner.location}` : 'Location not specified'}</p>  
                <p class="text-xs font-semibold ${availabilityClass} px-3 py-1 rounded-full mt-2">${runner.isavailable ? 'Available Now' : 'Currently Unavailable'}</p>  
                <p class="text-sm text-gray-600 italic mt-3 mb-4 line-clamp-3">${runner.about || 'This runner has not provided a bio yet.'}</p>  
                <button class="book-now-btn bg-maroon text-white px-5 py-2 rounded-full font-semibold hover:bg-gold hover:text-maroon transition duration-300 shadow mt-auto w-full" data-phone="${runner.phone || ''}" data-name="${runner.name}">Book Now</button>  
            `;  
            runnersListDiv.appendChild(runnerCard);  
        });  

        document.querySelectorAll('.animate-fade-in-slide-up').forEach(element => {  
            element.addEventListener('click', (event) => {  
                if (event.target.classList.contains('book-now-btn')) {  
                    return;  
                }  
                const runnerId = event.currentTarget.dataset.runnerId;  
                openRunnerModal(runnerId);  
            });  
        });  

        document.querySelectorAll('.book-now-btn').forEach(button => {  
            button.addEventListener('click', (event) => {  
                const phoneNumber = event.currentTarget.dataset.phone;  
                const runnerName = event.currentTarget.dataset.name;  
                if (phoneNumber) {  
                    alert(`To book with ${runnerName}, please call or WhatsApp this number: ${phoneNumber}`);  
                    window.location.href = `tel:${phoneNumber}`;  
                } else {  
                    alert(`We apologize, but ${runnerName} does not have a phone number listed. Please choose another runner.`);  
                }  
            });  
        });  
    }  

    // --- Backendless API Call ---  
    async function fetchRunnersData() {  
        setStatusMessage('loading', 'Fetching runners from the server...');  
        try {  
            const url = `https://api.backendless.com/${APP_ID}/${API_KEY}/data/Users?where=role%3D'runner'`;  
            const response = await fetch(url);  

            if (!response.ok) {  
                throw new Error('Network response was not ok');  
            }  

            const data = await response.json();  

            // Check if the returned data is an array  
            if (Array.isArray(data)) {  
                runnersData = data;  
                applyFiltersAndSort();  
            } else {  
                console.error("API did not return an array:", data);  
                setStatusMessage('fetch_error');  
            }  

        } catch (error) {  
            console.error("Failed to fetch runners:", error);  
            setStatusMessage('fetch_error');  
        }  
    }  

    // --- Filter and Sort Logic (fixed) ---  
    function applyFiltersAndSort() {  
        let filteredRunners = [...runnersData];  
          
        // 1. Filter by Location (case-insensitive, partial match allowed)  
        const selectedLocation = String(locationFilter.value || '').trim().toLowerCase();  
        if (selectedLocation !== 'all' && selectedLocation !== '') {  
            filteredRunners = filteredRunners.filter(runner => {  
                if (!runner.location) return false;  
                // normalize and allow partial matches (e.g., "nairobi" matches "Nairobi, Kenya")  
                return String(runner.location).toLowerCase().includes(selectedLocation);  
            });  
        }  

        // 2. Filter by Availability (handles boolean true and "true" string)  
        const selectedAvailability = String(availabilityFilter.value || '').trim();  
        if (selectedAvailability === 'Available') {  
            filteredRunners = filteredRunners.filter(runner => {  
                const val = runner.isavailable;  
                // treat true boolean or "true" (case-insensitive) as available  
                return val === true || String(val).toLowerCase() === 'true';  
            });  
        }  

        // 3. Sort  
        const selectedSort = sortBy.value;  
        filteredRunners.sort((a, b) => {  
            if (selectedSort === 'rating') {  
                return (b.rating || 0) - (a.rating || 0);  
            } else if (selectedSort === 'tasksCompleted') {  
                return (b.tasksCompleted || 0) - (a.tasksCompleted || 0);  
            }  
            return 0;  
        });  

        setTimeout(() => {  
            displayRunners(filteredRunners);  
        }, 700);  
    }  

    // --- Status Handling Functions ---  
    function setStatusMessage(type, message = null) {  
        noRunnersFoundDiv.classList.add('hidden');  
        fetchErrorDiv.classList.add('hidden');  
        runnersListDiv.innerHTML = '';  
        runnersListDiv.classList.remove('hidden');  

        if (type === 'loading') {  
            runnersListDiv.innerHTML = `  
                <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200"><div class="skeleton-circle mb-4 skeleton"></div><div class="skeleton-text long skeleton"></div><div class="skeleton-text short skeleton"></div><div class="skeleton-text skeleton w-full mt-3"></div><div class="skeleton-text skeleton w-1/2 mt-2"></div><div class="skeleton-text skeleton w-full h-8 mt-4"></div></div>  
                <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200"><div class="skeleton-circle mb-4 skeleton"></div><div class="skeleton-text long skeleton"></div><div class="skeleton-text short skeleton"></div><div class="skeleton-text skeleton w-full mt-3"></div><div class="skeleton-text skeleton w-1/2 mt-2"></div><div class="skeleton-text skeleton w-full h-8 mt-4"></div></div>  
                <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200 hidden lg:flex"><div class="skeleton-circle mb-4 skeleton"></div><div class="skeleton-text long skeleton"></div><div class="skeleton-text short skeleton"></div><div class="skeleton-text skeleton w-full mt-3"></div><div class="skeleton-text skeleton w-1/2 mt-2"></div><div class="skeleton-text skeleton w-full h-8 mt-4"></div></div>  
                <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-center text-center border border-gray-200 hidden xl:flex"><div class="skeleton-circle mb-4 skeleton"></div><div class="skeleton-text long skeleton"></div><div class="skeleton-text short skeleton"></div><div class="skeleton-text skeleton w-full mt-3"></div><div class="skeleton-text skeleton w-1/2 mt-2"></div><div class="skeleton-text skeleton w-full h-8 mt-4"></div></div>  
            `;  
        } else if (type === 'no_runners') {  
            noRunnersFoundDiv.classList.remove('hidden');  
        } else if (type === 'fetch_error') {  
            fetchErrorDiv.classList.remove('hidden');  
        }  
    }  

    // --- Modal Functions ---  
    function openRunnerModal(runnerId) {  
        const runner = runnersData.find(r => r.objectId === runnerId);  
        if (!runner) return;  

        const photoUrl = getRunnerImageUrl(runner.imageurl);  
        modalRunnerPhoto.src = photoUrl;  
        modalRunnerName.textContent = runner.name;  
        modalAboutRunnerName.textContent = runner.name;  
        modalRunnerRatingStars.innerHTML = generateStarRating(runner.rating || 0);  
        modalRunnerRatingValue.textContent = (runner.rating || 0).toFixed(1);  
        modalRunnerTasks.textContent = `(${runner.tasksCompleted || 0} tasks completed)`;  
        modalRunnerAvailability.textContent = runner.isavailable ? 'Available Now' : 'Currently Unavailable';  

        const availabilityClass = runner.isavailable ? 'bg-green-50 text-green-700 border border-green-300' : 'bg-red-50 text-red-700 border border-red-300';  
        modalRunnerAvailability.className = `text-md font-bold px-4 py-1 rounded-full inline-block mt-2 ${availabilityClass}`;  

        modalRunnerLocation.textContent = runner.location || 'Not specified';  
        modalRunnerMapLink.href = '#';  
        modalRunnerMapLink.classList.add('hidden');  

        modalRunnerBio.textContent = runner.about || 'This runner has not provided a bio yet.';  
          
        modalRunnerRate.textContent = runner.hourlyRate || 'Varies by task';  
        modalRunnerVehicle.textContent = runner.vehicle || 'Not specified';  
        modalRunnerResponseTime.textContent = runner.responseTime || 'N/A';  
        modalRunnerLanguages.textContent = (runner.languages || []).join(', ') || 'N/A';  

        modalRunnerReviews.innerHTML = '';  
        if (runner.reviews && runner.reviews.length > 0) {  
            runner.reviews.forEach(review => {  
                const reviewDiv = document.createElement('div');  
                reviewDiv.className = 'bg-gray-50 p-4 rounded-lg border border-gray-200';  
                reviewDiv.innerHTML = `  
                    <div class="flex items-center mb-2">  
                        <div class="flex mr-2">${generateStarRating(review.stars)}</div>  
                        <span class="font-semibold text-gray-800">${review.reviewer}</span>  
                    </div>  
                    <p class="text-sm text-gray-700 leading-relaxed">${review.text}</p>  
                `;  
                modalRunnerReviews.appendChild(reviewDiv);  
            });  
        } else {  
            modalRunnerReviews.innerHTML = '<p class="text-gray-500 text-sm italic">No reviews yet. Be the first to review!</p>';  
        }  

        modalCallNowBtn.onclick = () => {  
            if (runner.phone) {  
                alert(`To contact ${runner.name}, please call this number: ${runner.phone}`);  
                window.location.href = `tel:${runner.phone}`;  
            } else {  
                alert(`${runner.name} does not have a phone number listed.`);  
            }  
            closeRunnerModal();  
        };  

        runnerModal.style.display = 'flex';  
        document.body.classList.add('overflow-hidden');  
    }  

    function closeRunnerModal() {  
        runnerModal.style.display = 'none';  
        document.body.classList.remove('overflow-hidden');  
        modalCallNowBtn.onclick = null;  
    }  

    // --- Event Listeners ---  
    applyFiltersButton.addEventListener('click', applyFiltersAndSort);  
    locationFilter.addEventListener('change', applyFiltersAndSort);  
    availabilityFilter.addEventListener('change', applyFiltersAndSort);  
    sortBy.addEventListener('change', applyFiltersAndSort);  

    // Modal close listeners  
    closeModalButton.addEventListener('click', closeRunnerModal);  
    runnerModal.addEventListener('click', (event) => {  
        if (event.target === runnerModal) {  
            closeRunnerModal();  
        }  
    });  

    // Mobile menu toggle  
    mobileMenuButton.addEventListener('click', () => {  
        mobileMenu.classList.toggle('active');  
    });  

    // Back to Top button logic  
    window.addEventListener('scroll', () => {  
        if (window.scrollY > 300) {  
            backToTopButton.classList.remove('hidden');  
        } else {  
            backToTopButton.classList.add('hidden');  
        }  
    });  

    backToTopButton.addEventListener('click', () => {  
        window.scrollTo({  
            top: 0,  
            behavior: 'smooth'  
        });  
    });  

    // --- Initial Page Load ---  
    fetchRunnersData();  
});

</script> 
 </body>
           </html>
